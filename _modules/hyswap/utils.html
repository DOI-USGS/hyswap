

<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>hyswap.utils &#8212; hyswap 0.1.dev1+g4c3751d documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bizstyle.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">hyswap 0.1.dev1+g4c3751d documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">hyswap.utils</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for hyswap.utils</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Utility functions for hyswap.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<div class="viewcode-block" id="filter_approved_data"><a class="viewcode-back" href="../../reference/index.html#hyswap.utils.filter_approved_data">[docs]</a><span class="k">def</span> <span class="nf">filter_approved_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">filter_column</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter a dataframe to only return approved &quot;A&quot; (or &quot;A, e&quot;) data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : pandas.DataFrame</span>
<span class="sd">        The data to filter.</span>
<span class="sd">    filter_column : string</span>
<span class="sd">        The column upon which to filter. If None, an error will be raised.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas.DataFrame</span>
<span class="sd">        The filtered data.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Filter synthetic data to only return approved data. First make some</span>
<span class="sd">    synthetic data.</span>

<span class="sd">    .. doctest::</span>

<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame({</span>
<span class="sd">        ...     &#39;data&#39;: [1, 2, 3, 4],</span>
<span class="sd">        ...     &#39;approved&#39;: [&#39;A&#39;, &#39;A&#39;, &#39;P&#39;, &#39;P&#39;]})</span>
<span class="sd">        &gt;&gt;&gt; df.shape</span>
<span class="sd">        (4, 2)</span>

<span class="sd">    Then filter the data to only return approved data.</span>

<span class="sd">    .. doctest::</span>

<span class="sd">        &gt;&gt;&gt; df = utils.filter_approved_data(df, filter_column=&#39;approved&#39;)</span>
<span class="sd">        &gt;&gt;&gt; df.shape</span>
<span class="sd">        (2, 2)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filter_column</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;filter_column must be specified.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[((</span><span class="n">data</span><span class="p">[</span><span class="n">filter_column</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;A&quot;</span><span class="p">)</span> <span class="o">|</span>
                     <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">filter_column</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;A, e&quot;</span><span class="p">))]</span></div>


<div class="viewcode-block" id="rolling_average"><a class="viewcode-back" href="../../reference/index.html#hyswap.utils.rolling_average">[docs]</a><span class="k">def</span> <span class="nf">rolling_average</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">data_column_name</span><span class="p">,</span> <span class="n">data_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate a rolling average for a dataframe.</span>

<span class="sd">    Default behavior right-aligns the window used for the rolling average,</span>
<span class="sd">    and returns NaN values if any of the values in the window are NaN.</span>
<span class="sd">    Properties of the windowing can be changed by passing additional keyword</span>
<span class="sd">    arguments which are fed to `pandas.DataFrame.rolling`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pandas.DataFrame</span>
<span class="sd">        The dataframe to calculate the rolling average for.</span>
<span class="sd">    data_column_name : string</span>
<span class="sd">        The name of the column to calculate the rolling average for.</span>
<span class="sd">    data_type : string</span>
<span class="sd">        The formatted frequency string to be used with</span>
<span class="sd">        pandas.DataFrame.rolling to calculate the average over the correct</span>
<span class="sd">        temporal period.</span>
<span class="sd">    **kwargs</span>
<span class="sd">        Additional keyword arguments to be passed to</span>
<span class="sd">        `pandas.DataFrame.rolling`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pandas.DataFrame</span>
<span class="sd">        The output dataframe with the rolling average values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df_out</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df_out</span><span class="p">[</span><span class="n">data_column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_out</span><span class="p">[</span><span class="n">data_column_name</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span>
        <span class="n">data_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">df_out</span></div>


<div class="viewcode-block" id="filter_data_by_time"><a class="viewcode-back" href="../../reference/index.html#hyswap.utils.filter_data_by_time">[docs]</a><span class="k">def</span> <span class="nf">filter_data_by_time</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">data_column_name</span><span class="p">,</span> <span class="n">date_column_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">time_interval</span><span class="o">=</span><span class="s1">&#39;day&#39;</span><span class="p">,</span>
                        <span class="n">leading_values</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">trailing_values</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter data by some time interval.</span>

<span class="sd">    DataFrame containing data to filter. Expects datetime information to be</span>
<span class="sd">    available in the index or in a column named `date_column_name`. The</span>
<span class="sd">    returned `pandas.Series` object will have the datetimes for the specified</span>
<span class="sd">    time (day, month, year) as the index, and the corresponding data from the</span>
<span class="sd">    `data_column_name` column as the values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    value : int</span>
<span class="sd">        Time value to use for filtering; value can be a day of year (1-366),</span>
<span class="sd">        month (1-12), or year (4 digit year).</span>

<span class="sd">    data_column_name : str</span>
<span class="sd">        Name of column containing data to filter.</span>

<span class="sd">    date_column_name : str, optional</span>
<span class="sd">        Name of column containing date information. If None, the index of</span>
<span class="sd">        `df` is used.</span>

<span class="sd">    time_interval : str, optional</span>
<span class="sd">        Time interval to filter by. Must be one of &#39;day&#39;, &#39;month&#39;, or &#39;year&#39;.</span>
<span class="sd">        Default is &#39;day&#39;.</span>

<span class="sd">    leading_values : int, optional</span>
<span class="sd">        Number of leading values to include in the output, inclusive.</span>
<span class="sd">        Default is 0, and parameter only applies to &#39;day&#39; time_interval.</span>

<span class="sd">    trailing_values : int, optional</span>
<span class="sd">        Number of trailing values to include in the output, inclusive.</span>
<span class="sd">        Default is 0, and parameter only applies to &#39;day&#39; time_interval.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    data : pandas.Series</span>
<span class="sd">        Data from the specified day of year.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Filter some synthetic data by day of year. First make some synthetic data.</span>

<span class="sd">    .. doctest::</span>

<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame({</span>
<span class="sd">        ...     &#39;data&#39;: [1, 2, 3, 4],</span>
<span class="sd">        ...     &#39;date&#39;: pd.date_range(&#39;2019-01-01&#39;, &#39;2019-01-04&#39;)})</span>
<span class="sd">        &gt;&gt;&gt; df.shape</span>
<span class="sd">        (4, 2)</span>

<span class="sd">    Then filter the data to get data from day 1.</span>

<span class="sd">    .. doctest::</span>

<span class="sd">        &gt;&gt;&gt; data = utils.filter_data_by_time(</span>
<span class="sd">        ...     df, 1, &#39;data&#39;, date_column_name=&#39;date&#39;)</span>
<span class="sd">        &gt;&gt;&gt; data.shape</span>
<span class="sd">        (1,)</span>

<span class="sd">    Acquire and filter some real daily data to get all Jan. 1 data.</span>

<span class="sd">    .. doctest::</span>
<span class="sd">        :skipif: True  # dataretrieval functions break CI pipeline</span>

<span class="sd">        &gt;&gt;&gt; df, _ = dataretrieval.nwis.get_dv(</span>
<span class="sd">        ...     &quot;03586500&quot;, parameterCd=&quot;00060&quot;,</span>
<span class="sd">        ...     start=&quot;2000-01-01&quot;, end=&quot;2003-01-05&quot;)</span>
<span class="sd">        &gt;&gt;&gt; data = utils.filter_data_by_time(df, 1, &#39;00060_Mean&#39;)</span>
<span class="sd">        &gt;&gt;&gt; data.shape</span>
<span class="sd">        (4,)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># make date column the index if it is not already</span>
    <span class="k">if</span> <span class="n">date_column_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">date_column_name</span><span class="p">)</span>
    <span class="c1"># check that time_interval is valid</span>
    <span class="k">if</span> <span class="n">time_interval</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">&#39;time_interval must be one of &quot;day&quot;, &quot;month&quot;, or &quot;year&quot;.&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">time_interval</span> <span class="o">==</span> <span class="s1">&#39;day&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">leading_values</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">trailing_values</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="c1"># grab data from the specified day of year</span>
            <span class="n">dff</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofyear</span> <span class="o">==</span> <span class="n">value</span><span class="p">,</span> <span class="n">data_column_name</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># grab data from the specified day of year and include leading</span>
            <span class="c1"># and trailing values</span>
            <span class="n">dff</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofyear</span> <span class="o">&gt;=</span> <span class="n">value</span> <span class="o">-</span> <span class="n">leading_values</span><span class="p">)</span> <span class="o">&amp;</span>
                <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofyear</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">+</span> <span class="n">trailing_values</span><span class="p">),</span>
                <span class="n">data_column_name</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">time_interval</span> <span class="o">==</span> <span class="s1">&#39;month&#39;</span><span class="p">:</span>
        <span class="c1"># grab data from the specified month</span>
        <span class="n">dff</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="n">value</span><span class="p">,</span> <span class="n">data_column_name</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">time_interval</span> <span class="o">==</span> <span class="s1">&#39;year&#39;</span><span class="p">:</span>
        <span class="c1"># grab data from the specified year</span>
        <span class="n">dff</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="n">value</span><span class="p">,</span> <span class="n">data_column_name</span><span class="p">]</span>
    <span class="c1"># return data as a pandas Series where the index is the date</span>
    <span class="k">return</span> <span class="n">dff</span></div>


<div class="viewcode-block" id="calculate_metadata"><a class="viewcode-back" href="../../reference/index.html#hyswap.utils.calculate_metadata">[docs]</a><span class="k">def</span> <span class="nf">calculate_metadata</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate metadata for a series of data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : pandas.Series</span>
<span class="sd">        The data to calculate the metadata for. Expected to have a datetime</span>
<span class="sd">        index.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        The calculated metadata which includes the number of years of data,</span>
<span class="sd">        the number of data points, any gaps in the data, and the start and end</span>
<span class="sd">        dates of the data, the number of 0 values, the number of NA values,</span>
<span class="sd">        as well as the number of low (typically low flow &lt;= 0.01) values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># initialize the metadata dictionary</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># calculate the number of unique years of data</span>
    <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;n_years&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
    <span class="c1"># calculate the number of data points that are not nan</span>
    <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;n_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()])</span>
    <span class="c1"># calculate the number of gaps in the data - missing years</span>
    <span class="n">expected_years</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;n_missing_years&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">expected_years</span> <span class="o">-</span> <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;n_years&quot;</span><span class="p">]</span>
    <span class="c1"># calculate the start and end dates of the data</span>
    <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;start_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;end_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># calculate the number of 0 values</span>
    <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;n_zeros&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])</span>
    <span class="c1"># calculate the number of nan values</span>
    <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;n_nans&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()])</span>
    <span class="c1"># calculate the number of low values (below 0.01)</span>
    <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;n_lows&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span> <span class="o">&lt;=</span> <span class="mf">0.01</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">meta</span></div>


<div class="viewcode-block" id="define_year_doy_columns"><a class="viewcode-back" href="../../reference/index.html#hyswap.utils.define_year_doy_columns">[docs]</a><span class="k">def</span> <span class="nf">define_year_doy_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">date_column_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">year_type</span><span class="o">=</span><span class="s1">&#39;calendar&#39;</span><span class="p">,</span>
                            <span class="n">clip_leap_day</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to add year, day of year, and month-day columns to a DataFrame.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pandas.DataFrame</span>
<span class="sd">        DataFrame containing data to filter. Expects datetime information to be</span>
<span class="sd">        available in the index or in a column named `date_column_name`.</span>

<span class="sd">    date_column_name : str, optional</span>
<span class="sd">        Name of column containing date information. If None, the index of</span>
<span class="sd">        `df` is used.</span>

<span class="sd">    year_type : str, optional</span>
<span class="sd">        The type of year to use. Must be one of &#39;calendar&#39;, &#39;water&#39;, or</span>
<span class="sd">        &#39;climate&#39;. Default is &#39;calendar&#39; which starts the year on January 1</span>
<span class="sd">        and ends on December 31. &#39;water&#39; starts the year on October 1 and</span>
<span class="sd">        ends on September 30 of the following year which is the &quot;water year&quot;.</span>
<span class="sd">        For example, October 1, 2010 to September 30, 2011 is &quot;water year</span>
<span class="sd">        2011&quot;. &#39;climate&#39; years begin on April 1 and end on March 31 of the</span>
<span class="sd">        following year, they are numbered by the ending year. For example,</span>
<span class="sd">        April 1, 2010 to March 31, 2011 is &quot;climate year 2011&quot;.</span>

<span class="sd">    clip_leap_day : bool, optional</span>
<span class="sd">        If True, February 29 is removed from the DataFrame. Default is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df : pandas.DataFrame</span>
<span class="sd">        DataFrame with year, day of year, and month-day columns added. Also</span>
<span class="sd">        makes the date_column_name the index of the DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># set the df index</span>
    <span class="k">if</span> <span class="n">date_column_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">date_column_name</span><span class="p">)</span>
    <span class="c1"># check that year_type is valid</span>
    <span class="k">if</span> <span class="n">year_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;calendar&#39;</span><span class="p">,</span> <span class="s1">&#39;water&#39;</span><span class="p">,</span> <span class="s1">&#39;climate&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">&#39;year_type must be one of &quot;calendar&quot;, &quot;water&quot;, or &quot;climate&quot;.&#39;</span><span class="p">)</span>
    <span class="c1"># add year and day of year columns</span>
    <span class="k">if</span> <span class="n">year_type</span> <span class="o">==</span> <span class="s1">&#39;calendar&#39;</span><span class="p">:</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;index_year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;index_doy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofyear</span>
    <span class="k">elif</span> <span class="n">year_type</span> <span class="o">==</span> <span class="s1">&#39;water&#39;</span><span class="p">:</span>
        <span class="c1"># set water years</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;index_year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">,</span>
                                               <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># get calendar day of year</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;index_doy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofyear</span>
        <span class="c1"># adjust Oct 1 to be day 1 of water year for leap and non-leap years</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_leap_year</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">),</span>
               <span class="s1">&#39;index_doy&#39;</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">274</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_leap_year</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">),</span>
               <span class="s1">&#39;index_doy&#39;</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">273</span>
        <span class="c1"># adjust Jan 1 accordingly for leap and non-leap years</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;index_doy&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">92</span>
    <span class="k">elif</span> <span class="n">year_type</span> <span class="o">==</span> <span class="s1">&#39;climate&#39;</span><span class="p">:</span>
        <span class="c1"># set climate years</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;index_year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">,</span>
                                               <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># get calendar day of year</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;index_doy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofyear</span>
        <span class="c1"># adjust Apr 1 to be day 1 of climate year for leap and non-leap years</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_leap_year</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">),</span>
               <span class="s1">&#39;index_doy&#39;</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">91</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_leap_year</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">),</span>
               <span class="s1">&#39;index_doy&#39;</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">90</span>
        <span class="c1"># adjust Jan 1 to be day 276 of climate year for all years</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;index_doy&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">275</span>
    <span class="c1"># add month and day columns</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;index_month_day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1"># clip leap year and adjustment</span>
    <span class="k">if</span> <span class="n">clip_leap_day</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">leap_year_adjustment</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">year_type</span><span class="o">=</span><span class="n">year_type</span><span class="p">)</span>
    <span class="c1"># sort the df by year and day of year</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;index_year&#39;</span><span class="p">,</span> <span class="s1">&#39;index_doy&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">df</span></div>


<div class="viewcode-block" id="leap_year_adjustment"><a class="viewcode-back" href="../../reference/index.html#hyswap.utils.leap_year_adjustment">[docs]</a><span class="k">def</span> <span class="nf">leap_year_adjustment</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">year_type</span><span class="o">=</span><span class="s1">&#39;calendar&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to adjust leap year days in a DataFrame.</span>

<span class="sd">    Adjust for a leap year by removing February 29 from the DataFrame and</span>
<span class="sd">    adjusting the day of year values for the remaining days of the year.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pandas.DataFrame</span>
<span class="sd">        DataFrame containing data to adjust. Expects datetime information to be</span>
<span class="sd">        available in the index and a column named &#39;doy&#39; containing day of year.</span>

<span class="sd">    year_type : str, optional</span>
<span class="sd">        The type of year to use. Must be one of &#39;calendar&#39;, &#39;water&#39;, or</span>
<span class="sd">        &#39;climate&#39;. Default is &#39;calendar&#39; which starts the year on January 1</span>
<span class="sd">        and ends on December 31. &#39;water&#39; starts the year on October 1 and</span>
<span class="sd">        ends on September 30 of the following year which is the &quot;water year&quot;.</span>
<span class="sd">        For example, October 1, 2010 to September 30, 2011 is &quot;water year</span>
<span class="sd">        2011&quot;. &#39;climate&#39; years begin on April 1 and end on March 31 of the</span>
<span class="sd">        following year, they are numbered by the ending year. For example,</span>
<span class="sd">        April 1, 2010 to March 31, 2011 is &quot;climate year 2011&quot;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df : pandas.DataFrame</span>
<span class="sd">        DataFrame with leap year days removed and day of year values adjusted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">29</span><span class="p">))]</span>
    <span class="k">if</span> <span class="n">year_type</span> <span class="o">==</span> <span class="s1">&#39;calendar&#39;</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_leap_year</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">),</span>
               <span class="s1">&#39;index_doy&#39;</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">year_type</span> <span class="o">==</span> <span class="s1">&#39;water&#39;</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_leap_year</span> <span class="o">&amp;</span>
               <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span>
               <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">),</span> <span class="s1">&#39;index_doy&#39;</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">year_type</span> <span class="o">==</span> <span class="s1">&#39;climate&#39;</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_leap_year</span> <span class="o">&amp;</span>
               <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span>
               <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;index_doy&#39;</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">df</span></div>


<div class="viewcode-block" id="munge_nwis_stats"><a class="viewcode-back" href="../../reference/index.html#hyswap.utils.munge_nwis_stats">[docs]</a><span class="k">def</span> <span class="nf">munge_nwis_stats</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">source_pct_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target_pct_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">year_type</span><span class="o">=</span><span class="s1">&#39;calendar&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to munge and reformat NWIS statistics data.</span>

<span class="sd">    This is a utility function that exists to help munge NWIS percentile data</span>
<span class="sd">    served via the NWIS statistics web service. This function is intended to</span>
<span class="sd">    be used on Python dataretrieval dataframe returns for the nwis.get_stats()</span>
<span class="sd">    function for &quot;daily&quot; data, a single site, and a single parameter code.</span>

<span class="sd">    df : pandas.DataFrame</span>
<span class="sd">        DataFrame containing NWIS statistics data retrieved from the statistics</span>
<span class="sd">        web service. Assumed to come in as a dataframe retrieved with a</span>
<span class="sd">        package like dataretrieval or similar.</span>
<span class="sd">    source_pct_col : list, optional</span>
<span class="sd">        List of column names to use as the source percentiles. If None, the</span>
<span class="sd">        values are assumed to correspond to the 0, 5, 10, 25, 75, 90, 95,</span>
<span class="sd">        and 100 percentiles in the NWIS statistics service return.</span>
<span class="sd">    target_pct_col : list, optional</span>
<span class="sd">        List of column names to use as the target percentiles. If None, then</span>
<span class="sd">        integer values are used as the column names corresponding to the</span>
<span class="sd">        default source values.</span>
<span class="sd">    year_type : str, optional</span>
<span class="sd">        The type of year to use. Must be one of &#39;calendar&#39;, &#39;water&#39;, or</span>
<span class="sd">        &#39;climate&#39;. Default is &#39;calendar&#39; which starts the year on January 1</span>
<span class="sd">        and ends on December 31. &#39;water&#39; starts the year on October 1 and</span>
<span class="sd">        ends on September 30 of the following year which is the &quot;water year&quot;.</span>
<span class="sd">        For example, October 1, 2010 to September 30, 2011 is &quot;water year</span>
<span class="sd">        2011&quot;. &#39;climate&#39; years begin on April 1 and end on March 31 of the</span>
<span class="sd">        following year, they are numbered by the ending year. For example,</span>
<span class="sd">        April 1, 2010 to March 31, 2011 is &quot;climate year 2011&quot;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df_slim : pandas.DataFrame</span>
<span class="sd">        DataFrame containing munged and reformatted NWIS statistics data.</span>
<span class="sd">        Reformatting is for use with the hyswap package plotting function for</span>
<span class="sd">        duration hydrographs with statistical information in background of</span>
<span class="sd">        the plot.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Get some NWIS statistics data.</span>

<span class="sd">    .. doctest::</span>

<span class="sd">        &gt;&gt;&gt; df, md = dataretrieval.nwis.get_stats(</span>
<span class="sd">        ...     &quot;03586500&quot;, parameterCd=&quot;00060&quot;, statReportType=&quot;daily&quot;)</span>

<span class="sd">    Then apply the function to munge the data.</span>

<span class="sd">    .. doctest::</span>

<span class="sd">        &gt;&gt;&gt; df = utils.munge_nwis_stats(df)</span>
<span class="sd">        &gt;&gt;&gt; df.shape</span>
<span class="sd">        (366, 8)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># set defaults</span>
    <span class="k">if</span> <span class="n">source_pct_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">source_pct_col</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;min_va&#39;</span><span class="p">,</span> <span class="s1">&#39;p05_va&#39;</span><span class="p">,</span> <span class="s1">&#39;p10_va&#39;</span><span class="p">,</span> <span class="s1">&#39;p25_va&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;p75_va&#39;</span><span class="p">,</span> <span class="s1">&#39;p90_va&#39;</span><span class="p">,</span> <span class="s1">&#39;p95_va&#39;</span><span class="p">,</span> <span class="s1">&#39;max_va&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">target_pct_col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">target_pct_col</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
    <span class="c1"># check lengths of lists for column names</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">source_pct_col</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_pct_col</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;source_pct_col and target_pct_col must be the same &#39;</span>
                         <span class="s1">&#39;length&#39;</span><span class="p">)</span>
    <span class="c1"># rename date columns</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;month_nu&#39;</span><span class="p">:</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;day_nu&#39;</span><span class="p">:</span> <span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;end_yr&#39;</span><span class="p">:</span> <span class="s1">&#39;year&#39;</span><span class="p">},</span>
              <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># make end year 2020 for leap year</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2020</span>
    <span class="c1"># construct date column</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">]])</span>
    <span class="c1"># set doy_index and month-day as multi-index</span>
    <span class="n">month_day</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">doy_index</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">dayofyear</span>
    <span class="k">if</span> <span class="n">year_type</span> <span class="o">==</span> <span class="s1">&#39;water&#39;</span><span class="p">:</span>
        <span class="n">doy_index</span> <span class="o">=</span> <span class="n">doy_index</span> <span class="o">-</span> <span class="mi">273</span>
        <span class="n">doy_index</span><span class="p">[</span><span class="n">doy_index</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">365</span>
    <span class="k">elif</span> <span class="n">year_type</span> <span class="o">==</span> <span class="s1">&#39;climate&#39;</span><span class="p">:</span>
        <span class="n">doy_index</span> <span class="o">=</span> <span class="n">doy_index</span> <span class="o">-</span> <span class="mi">90</span>
        <span class="n">doy_index</span><span class="p">[</span><span class="n">doy_index</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">365</span>
    <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span>
        <span class="p">[</span><span class="n">doy_index</span><span class="p">,</span> <span class="n">month_day</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;doy&#39;</span><span class="p">,</span> <span class="s1">&#39;month-day&#39;</span><span class="p">])</span>
    <span class="c1"># slim down to just the columns used for the plot</span>
    <span class="n">df_slim</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">source_pct_col</span><span class="p">]</span>
    <span class="c1"># rename columns</span>
    <span class="n">df_slim</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">target_pct_col</span>
    <span class="c1"># return the dataframe</span>
    <span class="k">return</span> <span class="n">df_slim</span></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">hyswap 0.1.dev1+g4c3751d documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">hyswap.utils</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright .
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
    </div>
  </body>
</html>