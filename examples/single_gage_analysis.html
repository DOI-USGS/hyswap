

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Analysis of Streamflow Conditions and Historical Streamflows at a Single Gage &mdash; hyswap 0.1.dev1+g359fbc7e9 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=f7d90dbf"></script>
      <script src="../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Analysis of Streamflow N-Day Averages for a Single Gage" href="single_gage_n_day_flows_analysis.html" />
    <link rel="prev" title="Similarity Measures" href="similarity_examples.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            hyswap
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../meta/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Simple Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html#example-workflow-notebooks">Example Workflow Notebooks</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Analysis of Streamflow Conditions and Historical Streamflows at a Single Gage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Download-streamflow-data-from-USGS-Water-Data-for-an-example-site">Download streamflow data from USGS Water Data for an example site</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Perform-simple-data-check-and-exploration-by-plotting-hydrographs-of-select-water-years">Perform simple data check and exploration by plotting hydrographs of select water years</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Analyze-the-long-term-record-of-streamflow">Analyze the long-term record of streamflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Analyze-annual-streamflow-through-cumulative-flow-and-flow-duration-curves">Analyze annual streamflow through cumulative flow and flow duration curves</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="single_gage_n_day_flows_analysis.html">Analysis of Streamflow N-Day Averages for a Single Gage</a></li>
<li class="toctree-l2"><a class="reference internal" href="site_conditions_examples.html">Visualization of Streamflow Conditions at Streamgages</a></li>
<li class="toctree-l2"><a class="reference internal" href="regional_runoff_calculations.html">Using hyswap to estimate runoff for one and multiple HUC08s</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../meta/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../meta/calculations.html">Calculations Quick-Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../meta/contributing.html">Contributing Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../meta/disclaimer.html">Disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../meta/disclaimer.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Module Dependency Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html#api-reference">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hyswap</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Simple Examples</a></li>
      <li class="breadcrumb-item active">Analysis of Streamflow Conditions and Historical Streamflows at a Single Gage</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/single_gage_analysis.nblink.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Analysis-of-Streamflow-Conditions-and-Historical-Streamflows-at-a-Single-Gage">
<h1>Analysis of Streamflow Conditions and Historical Streamflows at a Single Gage<a class="headerlink" href="#Analysis-of-Streamflow-Conditions-and-Historical-Streamflows-at-a-Single-Gage" title="Link to this heading"></a></h1>
<p>This notebook provides a demonstration of the use of <a class="reference external" href="https://doi-usgs.github.io/hyswap/">hyswap</a> python package for analyzing streamflow conditions at a single streamgage including plotting of flow duration curves, duration hydrographs, and cumulative streamflow.</p>
<p>This example notebook relies on use of the <a class="reference external" href="https://github.com/DOI-USGS/dataRetrieval">dataretrieval</a> package for downloading streamflow information from the <a class="reference external" href="https://api.waterdata.usgs.gov/">USGS Water Data APIs</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dataretrieval</span> <span class="kn">import</span> <span class="n">waterdata</span>
<span class="kn">from</span> <span class="nn">hyswap</span> <span class="kn">import</span> <span class="n">exceedance</span><span class="p">,</span> <span class="n">percentiles</span><span class="p">,</span> <span class="n">plots</span><span class="p">,</span> <span class="n">rasterhydrograph</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># ignore warnings from dataretrieval</span>
</pre></div>
</div>
</div>
<section id="Download-streamflow-data-from-USGS-Water-Data-for-an-example-site">
<h2>Download streamflow data from USGS Water Data for an example site<a class="headerlink" href="#Download-streamflow-data-from-USGS-Water-Data-for-an-example-site" title="Link to this heading"></a></h2>
<p>For demonstration purposes, retrieving data for gage 04288000 - MAD RIVER AT MORETOWN, VT.</p>
<p>Users can identify streamflow gage locations and site ID numbers through the <a class="reference external" href="https://dashboard.waterdata.usgs.gov/app/nwd/en/">USGS National Water Dashboard</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">StaID</span> <span class="o">=</span> <span class="s1">&#39;USGS-04288000&#39;</span>
<span class="n">flow_data</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">waterdata</span><span class="o">.</span><span class="n">get_daily</span><span class="p">(</span>
    <span class="n">monitoring_location_id</span><span class="o">=</span><span class="n">StaID</span><span class="p">,</span>
    <span class="n">parameter_code</span><span class="o">=</span><span class="s1">&#39;00060&#39;</span><span class="p">,</span>
    <span class="n">time</span><span class="o">=</span><span class="s1">&#39;1900-01-01/..&#39;</span><span class="p">,</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">[</span>
        <span class="s1">&#39;monitoring_location_id&#39;</span><span class="p">,</span>
        <span class="s1">&#39;parameter_code&#39;</span><span class="p">,</span>
        <span class="s1">&#39;time&#39;</span><span class="p">,</span>
        <span class="s1">&#39;value&#39;</span><span class="p">,</span>
        <span class="s1">&#39;unit_of_measure&#39;</span><span class="p">,</span>
        <span class="s1">&#39;approval_status&#39;</span><span class="p">])</span>

<span class="n">station_name</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">waterdata</span><span class="o">.</span><span class="n">get_monitoring_locations</span><span class="p">(</span>
    <span class="n">monitoring_location_id</span><span class="o">=</span><span class="n">StaID</span><span class="p">)</span>
<span class="n">station_name</span> <span class="o">=</span> <span class="n">station_name</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;monitoring_location_name&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s1">&#39;value&#39;</span> <span class="ow">in</span> <span class="n">flow_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="c1"># set preliminary, non-valid observations (-999999) to NaN</span>
    <span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mi">999999</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="c1"># create a filtered version of data of only USGS approved data (quality-assured data that may be published and used in statistical analsysis)</span>
    <span class="n">approved_flow_data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">filter_approved_data</span><span class="p">(</span><span class="n">flow_data</span><span class="p">,</span> <span class="s1">&#39;approval_status&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No standard discharge data column found for site &#39;</span> <span class="o">+</span> <span class="n">StaID</span> <span class="o">+</span> <span class="s1">&#39;, suggest using a different site&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># view a sample of data records</span>
<span class="n">flow_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>monitoring_location_id</th>
      <th>parameter_code</th>
      <th>time</th>
      <th>value</th>
      <th>unit_of_measure</th>
      <th>approval_status</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>USGS-04288000</td>
      <td>00060</td>
      <td>1928-10-01</td>
      <td>70.0</td>
      <td>ft^3/s</td>
      <td>Approved</td>
      <td>POINT (-72.74262 44.27728)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>USGS-04288000</td>
      <td>00060</td>
      <td>1928-10-02</td>
      <td>70.0</td>
      <td>ft^3/s</td>
      <td>Approved</td>
      <td>POINT (-72.74262 44.27728)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>USGS-04288000</td>
      <td>00060</td>
      <td>1928-10-03</td>
      <td>70.0</td>
      <td>ft^3/s</td>
      <td>Approved</td>
      <td>POINT (-72.74262 44.27728)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>USGS-04288000</td>
      <td>00060</td>
      <td>1928-10-04</td>
      <td>70.0</td>
      <td>ft^3/s</td>
      <td>Approved</td>
      <td>POINT (-72.74262 44.27728)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>USGS-04288000</td>
      <td>00060</td>
      <td>1928-10-05</td>
      <td>65.0</td>
      <td>ft^3/s</td>
      <td>Approved</td>
      <td>POINT (-72.74262 44.27728)</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Perform-simple-data-check-and-exploration-by-plotting-hydrographs-of-select-water-years">
<h2>Perform simple data check and exploration by plotting hydrographs of select water years<a class="headerlink" href="#Perform-simple-data-check-and-exploration-by-plotting-hydrographs-of-select-water-years" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| fig-cap: Sample HySwap hydrograph plot</span>
<span class="n">plot_start</span> <span class="o">=</span> <span class="s2">&quot;2024-10-01&quot;</span>
<span class="n">plot_end</span> <span class="o">=</span> <span class="s2">&quot;2025-09-30&quot;</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plots</span><span class="o">.</span><span class="n">plot_hydrograph</span><span class="p">(</span><span class="n">flow_data</span><span class="p">,</span>
                           <span class="n">data_column_name</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span>
                           <span class="n">date_column_name</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>
                           <span class="n">start_date</span> <span class="o">=</span> <span class="n">plot_start</span><span class="p">,</span>
                           <span class="n">end_date</span> <span class="o">=</span> <span class="n">plot_end</span><span class="p">,</span>
                           <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Hydrograph for </span><span class="si">{</span><span class="n">StaID</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">station_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                           <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_single_gage_analysis_8_0.png" src="../_images/examples_single_gage_analysis_8_0.png" />
</div>
</div>
<p>Next, try changing the plot to not have log scale on the y-axis</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| fig-cap: Sample HySwap hydrograph plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plots</span><span class="o">.</span><span class="n">plot_hydrograph</span><span class="p">(</span><span class="n">flow_data</span><span class="p">,</span>
                       <span class="n">data_column_name</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span>
                       <span class="n">date_column_name</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>
                       <span class="n">start_date</span><span class="o">=</span><span class="n">plot_start</span><span class="p">,</span>
                       <span class="n">end_date</span><span class="o">=</span><span class="n">plot_end</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Hydrograph for </span><span class="si">{</span><span class="n">StaID</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">station_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                       <span class="n">yscale</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                       <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_single_gage_analysis_10_0.png" src="../_images/examples_single_gage_analysis_10_0.png" />
</div>
</div>
<p>Now test doing some plot customizations including axis labels, colors, plot style</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| fig-cap: Sample HySwap hydrograph plot with customized appearance</span>
<span class="n">plot_start</span> <span class="o">=</span> <span class="s2">&quot;2024-10-01&quot;</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plots</span><span class="o">.</span><span class="n">plot_hydrograph</span><span class="p">(</span><span class="n">flow_data</span><span class="p">,</span>
                       <span class="n">data_column_name</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span>
                       <span class="n">date_column_name</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>
                       <span class="n">start_date</span><span class="o">=</span><span class="n">plot_start</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Hydrograph for </span><span class="si">{</span><span class="n">StaID</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">station_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                       <span class="n">yscale</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                       <span class="n">ylab</span> <span class="o">=</span> <span class="s1">&#39;Streamflow (cfs)&#39;</span><span class="p">,</span>
                       <span class="n">xlab</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                       <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;#360919&#39;</span><span class="p">,</span>
                       <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span> <span class="o">=</span> <span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span> <span class="o">=</span> <span class="s2">&quot;minor&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_single_gage_analysis_12_0.png" src="../_images/examples_single_gage_analysis_12_0.png" />
</div>
</div>
</section>
<section id="Analyze-the-long-term-record-of-streamflow">
<h2>Analyze the long-term record of streamflow<a class="headerlink" href="#Analyze-the-long-term-record-of-streamflow" title="Link to this heading"></a></h2>
<p>Review summary statistics and flow records using raster hydrographs</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate summary statistics on only approved data (quality-assured data that may be published and used in statistical analsysis)</span>
<span class="n">summary_stats</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">calculate_summary_statistics</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">approved_flow_data</span><span class="p">,</span>
    <span class="n">data_column_name</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span>
    <span class="n">date_column_name</span><span class="o">=</span><span class="s1">&#39;time&#39;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| tbl-cap: Example table of summary statistics</span>
<span class="n">summary_stats</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Summary Statistics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Site number</th>
      <td>USGS-04288000</td>
    </tr>
    <tr>
      <th>Begin date</th>
      <td>1928-10-01</td>
    </tr>
    <tr>
      <th>End date</th>
      <td>2025-07-30</td>
    </tr>
    <tr>
      <th>Count</th>
      <td>35367</td>
    </tr>
    <tr>
      <th>Minimum</th>
      <td>2.9</td>
    </tr>
    <tr>
      <th>Mean</th>
      <td>275.58</td>
    </tr>
    <tr>
      <th>Median</th>
      <td>150.0</td>
    </tr>
    <tr>
      <th>Maximum</th>
      <td>6840.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>To view long-term patterns and trends in streamflow, raster hydrographs can be plotted using <code class="docutils literal notranslate"><span class="pre">hyswap</span></code>. Here, let’s utilize a raster hydrograph to see the historical flow at the site from the past 50 years (1973-2023)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># format the data</span>
<span class="n">df_formatted</span> <span class="o">=</span> <span class="n">rasterhydrograph</span><span class="o">.</span><span class="n">format_data</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">flow_data</span><span class="p">,</span>
    <span class="n">data_column_name</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span>
    <span class="n">date_column_name</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>
    <span class="n">year_type</span><span class="o">=</span><span class="s2">&quot;calendar&quot;</span><span class="p">,</span>
    <span class="n">begin_year</span><span class="o">=</span><span class="mi">1973</span><span class="p">,</span>
    <span class="n">end_year</span><span class="o">=</span><span class="mi">2023</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| fig-cap: Sample raster hydrograph showing past 50 years of streamflow</span>
<span class="c1"># make plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plots</span><span class="o">.</span><span class="n">plot_raster_hydrograph</span><span class="p">(</span>
    <span class="n">df_formatted</span><span class="o">=</span><span class="n">df_formatted</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Raster Hydrograph for </span><span class="si">{</span><span class="n">StaID</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">station_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_single_gage_analysis_18_0.png" src="../_images/examples_single_gage_analysis_18_0.png" />
</div>
</div>
<p>Next, try customizing the raster hydrograph by changing to water years, using a different colormap, removing the leap day, and showing all years that have data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># re-format data</span>
<span class="n">df_formatted</span> <span class="o">=</span> <span class="n">rasterhydrograph</span><span class="o">.</span><span class="n">format_data</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">flow_data</span><span class="p">,</span>
    <span class="n">data_column_name</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span>
    <span class="n">date_column_name</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>
    <span class="n">year_type</span><span class="o">=</span><span class="s2">&quot;water&quot;</span><span class="p">,</span>
    <span class="n">clip_leap_day</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| fig-cap: Sample raster hydrograph showing all daily streamflow records from a site</span>
<span class="c1"># make plot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plots</span><span class="o">.</span><span class="n">plot_raster_hydrograph</span><span class="p">(</span>
    <span class="n">df_formatted</span><span class="o">=</span><span class="n">df_formatted</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Raster Hydrograph for </span><span class="si">{</span><span class="n">StaID</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">station_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_ncar&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_single_gage_analysis_21_0.png" src="../_images/examples_single_gage_analysis_21_0.png" />
</div>
</div>
</section>
<section id="Analyze-annual-streamflow-through-cumulative-flow-and-flow-duration-curves">
<h2>Analyze annual streamflow through cumulative flow and flow duration curves<a class="headerlink" href="#Analyze-annual-streamflow-through-cumulative-flow-and-flow-duration-curves" title="Link to this heading"></a></h2>
<p>Use calculations of streamflow percentiles (variable by day) to analyze annual patterns in streamflow</p>
<p>Let’s look at the last four years (2020-2023) of cumulative streamflow by plotting cumulative hydrographs of different water years along with the envelope that 90% of annual cumulative streamflow is expected to be within, and the years with the minimum and maximum annual cumulative streamflows.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| fig-cap: Sample cumulative hydrograph showing multiple water years of cumulative streamflow</span>
<span class="n">years_to_plot</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">2023</span><span class="p">,</span> <span class="mi">2024</span><span class="p">,</span> <span class="mi">2025</span><span class="p">]</span>
<span class="c1"># plot the cumulative streamflow hydrograph</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plots</span><span class="o">.</span><span class="n">plot_cumulative_hydrograph</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">flow_data</span><span class="p">,</span>
    <span class="n">data_column_name</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span>
    <span class="n">date_column_name</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>
    <span class="n">target_years</span><span class="o">=</span><span class="n">years_to_plot</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Cumulative Streamflow Hydrograph for </span><span class="si">{</span><span class="n">StaID</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">station_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">envelope_pct</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">95</span><span class="p">],</span>
    <span class="n">max_year</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">min_year</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">year_type</span> <span class="o">=</span> <span class="s1">&#39;water&#39;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_single_gage_analysis_23_0.png" src="../_images/examples_single_gage_analysis_23_0.png" />
</div>
</div>
<p>Next, look at the flow duration curve for a site</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create data for flow duration curve</span>
<span class="c1"># generate 1,000 evenly spaced values between the min and max flow to create a smooth line</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">flow_data</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="c1"># calculate exceedance probabilities from the daily mean streamflow values using only approved data</span>
<span class="n">exceedance_probabilities</span> <span class="o">=</span> <span class="n">exceedance</span><span class="o">.</span><span class="n">calculate_exceedance_probability_from_values_multiple</span><span class="p">(</span>
    <span class="n">values</span><span class="p">,</span> <span class="n">approved_flow_data</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| fig-cap: Example flow duration curve for a single gage</span>
<span class="c1"># plot the flow duration curve</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plots</span><span class="o">.</span><span class="n">plot_flow_duration_curve</span><span class="p">(</span>
    <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
    <span class="n">exceedance_probabilities</span><span class="o">=</span><span class="n">exceedance_probabilities</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Flow Duration Curve for </span><span class="si">{</span><span class="n">StaID</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">station_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1"># show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_single_gage_analysis_26_0.png" src="../_images/examples_single_gage_analysis_26_0.png" />
</div>
</div>
<p>Next, look at the seasonality and variability of streamflow at a single site by plotting a streamflow duration hydrograph.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create data for streamflow duration hydrograph from approved flow data</span>
<span class="n">percentiles_by_day</span> <span class="o">=</span> <span class="n">percentiles</span><span class="o">.</span><span class="n">calculate_variable_percentile_thresholds_by_day</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">approved_flow_data</span><span class="p">,</span>
    <span class="n">data_column_name</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
    <span class="n">date_column_name</span><span class="o">=</span><span class="s2">&quot;time&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| tbl-cap: Calculated streamflow percentile thresholds for a streamgage</span>
<span class="c1"># View a sample of this data</span>
<span class="n">display</span><span class="p">(</span><span class="n">percentiles_by_day</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min</th>
      <th>p05</th>
      <th>p10</th>
      <th>p25</th>
      <th>p50</th>
      <th>p75</th>
      <th>p90</th>
      <th>p95</th>
      <th>max</th>
      <th>mean</th>
      <th>count</th>
      <th>start_yr</th>
      <th>end_yr</th>
    </tr>
    <tr>
      <th>month_day</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>01-01</th>
      <td>42.0</td>
      <td>55.9</td>
      <td>70.0</td>
      <td>108.0</td>
      <td>155.0</td>
      <td>292.5</td>
      <td>461.8</td>
      <td>804.4</td>
      <td>1780.0</td>
      <td>249.55</td>
      <td>97</td>
      <td>1929</td>
      <td>2025</td>
    </tr>
    <tr>
      <th>01-02</th>
      <td>45.0</td>
      <td>53.8</td>
      <td>70.0</td>
      <td>105.0</td>
      <td>153.0</td>
      <td>297.5</td>
      <td>498.0</td>
      <td>692.9</td>
      <td>1500.0</td>
      <td>238.15</td>
      <td>97</td>
      <td>1929</td>
      <td>2025</td>
    </tr>
    <tr>
      <th>01-03</th>
      <td>45.0</td>
      <td>53.7</td>
      <td>77.4</td>
      <td>110.0</td>
      <td>160.0</td>
      <td>278.0</td>
      <td>424.0</td>
      <td>522.4</td>
      <td>800.0</td>
      <td>214.72</td>
      <td>97</td>
      <td>1929</td>
      <td>2025</td>
    </tr>
    <tr>
      <th>01-04</th>
      <td>40.0</td>
      <td>56.0</td>
      <td>77.8</td>
      <td>102.5</td>
      <td>170.0</td>
      <td>289.0</td>
      <td>393.6</td>
      <td>536.0</td>
      <td>680.0</td>
      <td>207.44</td>
      <td>97</td>
      <td>1929</td>
      <td>2025</td>
    </tr>
    <tr>
      <th>01-05</th>
      <td>36.0</td>
      <td>58.8</td>
      <td>75.6</td>
      <td>104.0</td>
      <td>155.0</td>
      <td>254.5</td>
      <td>360.0</td>
      <td>500.3</td>
      <td>1470.0</td>
      <td>212.14</td>
      <td>97</td>
      <td>1929</td>
      <td>2025</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#| fig-cap: Example Streamflow Duration Hydrograph for a Streamgage</span>
<span class="c1"># plotting percentiles by day with line shade between</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">water_year_to_plot</span> <span class="o">=</span> <span class="mi">2025</span>
<span class="c1"># get year/doy information</span>
<span class="n">df_indexed</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">define_year_doy_columns</span><span class="p">(</span>
    <span class="n">df_in</span><span class="o">=</span><span class="n">flow_data</span><span class="p">,</span>
    <span class="n">date_column_name</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span>
    <span class="n">year_type</span><span class="o">=</span><span class="s1">&#39;water&#39;</span><span class="p">,</span>
    <span class="n">clip_leap_day</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
<span class="c1"># filter down to data from selected year</span>
<span class="n">df_year</span> <span class="o">=</span> <span class="n">df_indexed</span><span class="p">[</span><span class="n">df_indexed</span><span class="p">[</span><span class="s1">&#39;index_year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">water_year_to_plot</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># plot data</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plots</span><span class="o">.</span><span class="n">plot_duration_hydrograph</span><span class="p">(</span>
    <span class="n">percentiles_by_day</span><span class="o">=</span><span class="n">percentiles_by_day</span><span class="p">,</span>
    <span class="n">df</span><span class="o">=</span><span class="n">df_year</span><span class="p">,</span>
    <span class="n">data_column_name</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">data_label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Water Year </span><span class="si">{</span><span class="n">water_year_to_plot</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Streamflow Duration Hydrograph for </span><span class="si">{</span><span class="n">StaID</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">station_name</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_single_gage_analysis_30_0.png" src="../_images/examples_single_gage_analysis_30_0.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="similarity_examples.html" class="btn btn-neutral float-left" title="Similarity Measures" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="single_gage_n_day_flows_analysis.html" class="btn btn-neutral float-right" title="Analysis of Streamflow N-Day Averages for a Single Gage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>