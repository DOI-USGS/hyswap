

<!doctype html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Similarity Measures &#8212; hyswap 0.1.dev1+gf39d874 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/bizstyle.css?v=f15d3b81" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/documentation_options.js?v=99aedded"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Glossary" href="../meta/glossary.html" />
    <link rel="prev" title="Percentile Calculation Examples" href="percentile_calculation_examples.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../meta/glossary.html" title="Glossary"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="percentile_calculation_examples.html" title="Percentile Calculation Examples"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">hyswap 0.1.dev1+gf39d874 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Examples</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Similarity Measures</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="similarity-measures">
<h1>Similarity Measures<a class="headerlink" href="#similarity-measures" title="Link to this heading">¶</a></h1>
<p>These examples showcase the usage of the functions in the <cite>similarity</cite> module, with heatmap visualizations via the <a class="reference internal" href="../reference/index.html#hyswap.plots.plot_similarity_heatmap" title="hyswap.plots.plot_similarity_heatmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hyswap.plots.plot_similarity_heatmap</span></code></a> function.
Sometimes it is helpful to compare the relationships between a set of stations and their respective measurements.
The <cite>similarity</cite> functions packaged in <cite>hyswap</cite> handle some of the data clean-up for you by ensuring the time-series of observations being compared at the same, and by removing any missing data.
This ensures that your results are not skewed by missing data or gaps in one of the time-series.</p>
<section id="correlations-between-5-stations">
<h2>Correlations Between 5 Stations<a class="headerlink" href="#correlations-between-5-stations" title="Link to this heading">¶</a></h2>
<p>The following example shows the correlations between streamflow at 5 stations (07374525, 07374000, 07289000, 07032000, 07024175) along the Mississippi River, listed from downstream to upstream.
First we have to fetch the streamflow data for these stations, to do this we will use the <cite>dataretrieval</cite> package to access the NWIS database.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the data from these 5 sites</span>
<span class="n">site_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;07374525&quot;</span><span class="p">,</span> <span class="s2">&quot;07374000&quot;</span><span class="p">,</span> <span class="s2">&quot;07289000&quot;</span><span class="p">,</span> <span class="s2">&quot;07032000&quot;</span><span class="p">,</span> <span class="s2">&quot;07024175&quot;</span><span class="p">]</span>

<span class="c1"># fetch some streamflow data from NWIS as a list of dataframes</span>
<span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">site_list</span><span class="p">:</span>
    <span class="n">df</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">dataretrieval</span><span class="o">.</span><span class="n">nwis</span><span class="o">.</span><span class="n">get_dv</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;2012-01-01&quot;</span><span class="p">,</span>
                                      <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2022-12-31&quot;</span><span class="p">,</span>
                                      <span class="n">parameterCd</span><span class="o">=</span><span class="s1">&#39;00060&#39;</span><span class="p">)</span>
    <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<p>Once we’ve collected the streamflow data, we will calculate the pair-wise correlations between the stations using the <a class="reference internal" href="../reference/index.html#hyswap.similarity.calculate_correlations" title="hyswap.similarity.calculate_correlations"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hyswap.similarity.calculate_correlations</span></code></a> function and then plot the results using <a class="reference internal" href="../reference/index.html#hyswap.plots.plot_similarity_heatmap" title="hyswap.plots.plot_similarity_heatmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hyswap.plots.plot_similarity_heatmap</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate correlations</span>
<span class="n">results</span><span class="p">,</span> <span class="n">n_obs</span> <span class="o">=</span> <span class="n">hyswap</span><span class="o">.</span><span class="n">similarity</span><span class="o">.</span><span class="n">calculate_correlations</span><span class="p">(</span><span class="n">df_list</span><span class="p">,</span> <span class="s2">&quot;00060_Mean&quot;</span><span class="p">)</span>

<span class="c1"># make plot</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">hyswap</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">plot_similarity_heatmap</span><span class="p">(</span>
    <span class="n">results</span><span class="p">,</span> <span class="n">n_obs</span><span class="o">=</span><span class="n">n_obs</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Pearson Correlation Coefficients for Streamflow</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
          <span class="s2">&quot;Between 5 Sites Along the Mississippi River&quot;</span><span class="p">)</span>

<span class="c1"># show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/77bff4448d915acc8b9cce71410ee204/similarity_examples-2.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/c2ab381d3f41e6c05566af9eb27f5932/similarity_examples-2.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/similarity_examples-2.png" class="plot-directive" src="../_images/similarity_examples-2.png" />
</figure>
<p>If we’d like, we can display the specific values of the correlations by setting the <cite>show_values</cite> argument to <cite>True</cite> in the <a class="reference internal" href="../reference/index.html#hyswap.plots.plot_similarity_heatmap" title="hyswap.plots.plot_similarity_heatmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hyswap.plots.plot_similarity_heatmap</span></code></a> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the data from these 5 sites</span>
<span class="n">site_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;07374525&quot;</span><span class="p">,</span> <span class="s2">&quot;07374000&quot;</span><span class="p">,</span> <span class="s2">&quot;07289000&quot;</span><span class="p">,</span> <span class="s2">&quot;07032000&quot;</span><span class="p">,</span> <span class="s2">&quot;07024175&quot;</span><span class="p">]</span>

<span class="c1"># fetch some streamflow data from NWIS as a list of dataframes</span>
<span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">site_list</span><span class="p">:</span>
    <span class="n">df</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">dataretrieval</span><span class="o">.</span><span class="n">nwis</span><span class="o">.</span><span class="n">get_dv</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;2012-01-01&quot;</span><span class="p">,</span>
                                      <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2022-12-31&quot;</span><span class="p">,</span>
                                      <span class="n">parameterCd</span><span class="o">=</span><span class="s1">&#39;00060&#39;</span><span class="p">)</span>
    <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># calculate correlations</span>
<span class="n">results</span><span class="p">,</span> <span class="n">n_obs</span> <span class="o">=</span> <span class="n">hyswap</span><span class="o">.</span><span class="n">similarity</span><span class="o">.</span><span class="n">calculate_correlations</span><span class="p">(</span><span class="n">df_list</span><span class="p">,</span> <span class="s2">&quot;00060_Mean&quot;</span><span class="p">)</span>

<span class="c1"># make plot</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">hyswap</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">plot_similarity_heatmap</span><span class="p">(</span>
    <span class="n">results</span><span class="p">,</span> <span class="n">n_obs</span><span class="o">=</span><span class="n">n_obs</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Pearson Correlation Coefficients for Streamflow</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
          <span class="s2">&quot;Between 5 Sites Along the Mississippi River&quot;</span><span class="p">,</span>
    <span class="n">show_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/e0cbf90d607cb28567961a67b21cda1a/similarity_examples-3.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/b3620d145d83b447a4fc98b4bb4ffeaf/similarity_examples-3.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/similarity_examples-3.png" class="plot-directive" src="../_images/similarity_examples-3.png" />
</figure>
</section>
<section id="wasserstein-distances-between-5-stations">
<h2>Wasserstein Distances Between 5 Stations<a class="headerlink" href="#wasserstein-distances-between-5-stations" title="Link to this heading">¶</a></h2>
<p>In this example we compare the same 5 time-series as the previous example, but instead of calculating correlations, we calculate the <a class="reference external" href="wasserstein_doc">Wasserstein Distance</a> between each pairing of time-series.
The Wasserstein Distance is a measure of the distance between two probability distributions, in this case the probability distributions of the streamflow values at each station.
Specifically in <cite>hyswap</cite>, we utilize the <cite>scipy.stats.wasserstein_distance()</cite> function, and are therefore specifically calculating the “first” Wasserstein Distance between two time-series.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the data from these 5 sites</span>
<span class="n">site_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;07374525&quot;</span><span class="p">,</span> <span class="s2">&quot;07374000&quot;</span><span class="p">,</span> <span class="s2">&quot;07289000&quot;</span><span class="p">,</span> <span class="s2">&quot;07032000&quot;</span><span class="p">,</span> <span class="s2">&quot;07024175&quot;</span><span class="p">]</span>

<span class="c1"># fetch some streamflow data from NWIS as a list of dataframes</span>
<span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">site_list</span><span class="p">:</span>
    <span class="n">df</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">dataretrieval</span><span class="o">.</span><span class="n">nwis</span><span class="o">.</span><span class="n">get_dv</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;2012-01-01&quot;</span><span class="p">,</span>
                                      <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2022-12-31&quot;</span><span class="p">,</span>
                                      <span class="n">parameterCd</span><span class="o">=</span><span class="s1">&#39;00060&#39;</span><span class="p">)</span>
    <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># calculate Wasserstein Distances</span>
<span class="n">results</span><span class="p">,</span> <span class="n">n_obs</span> <span class="o">=</span> <span class="n">hyswap</span><span class="o">.</span><span class="n">similarity</span><span class="o">.</span><span class="n">calculate_wasserstein_distance</span><span class="p">(</span><span class="n">df_list</span><span class="p">,</span> <span class="s2">&quot;00060_Mean&quot;</span><span class="p">)</span>

<span class="c1"># make plot</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">hyswap</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">plot_similarity_heatmap</span><span class="p">(</span>
    <span class="n">results</span><span class="p">,</span> <span class="n">n_obs</span><span class="o">=</span><span class="n">n_obs</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Wasserstein Distances for Streamflow</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
          <span class="s2">&quot;Between 5 Sites Along the Mississippi River&quot;</span><span class="p">,</span>
    <span class="n">show_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/d5581bd2b32570239e1161370cb8362e/similarity_examples-4.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/40423e11d6e99b58c33bb0d76dda903f/similarity_examples-4.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/similarity_examples-4.png" class="plot-directive" src="../_images/similarity_examples-4.png" />
</figure>
</section>
<section id="energy-distances-between-5-stations">
<h2>Energy Distances Between 5 Stations<a class="headerlink" href="#energy-distances-between-5-stations" title="Link to this heading">¶</a></h2>
<p>In this example we compare the same 5 time-series as the previous example, but this time using another distance measure, the so-called “Energy Distance” between two time-series.
The <a class="reference external" href="energy_dist">Energy Distance</a> is a statistical distance between two probability distributions, in this case the probability distributions of the streamflow values at each station.
Specifically in <cite>hyswap</cite>, we utilize the <cite>scipy.stats.energy_distance()</cite> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the data from these 5 sites</span>
<span class="n">site_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;07374525&quot;</span><span class="p">,</span> <span class="s2">&quot;07374000&quot;</span><span class="p">,</span> <span class="s2">&quot;07289000&quot;</span><span class="p">,</span> <span class="s2">&quot;07032000&quot;</span><span class="p">,</span> <span class="s2">&quot;07024175&quot;</span><span class="p">]</span>

<span class="c1"># fetch some streamflow data from NWIS as a list of dataframes</span>
<span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">site_list</span><span class="p">:</span>
    <span class="n">df</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">dataretrieval</span><span class="o">.</span><span class="n">nwis</span><span class="o">.</span><span class="n">get_dv</span><span class="p">(</span><span class="n">site</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;2012-01-01&quot;</span><span class="p">,</span>
                                      <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2022-12-31&quot;</span><span class="p">,</span>
                                      <span class="n">parameterCd</span><span class="o">=</span><span class="s1">&#39;00060&#39;</span><span class="p">)</span>
    <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># calculate Wasserstein Distances</span>
<span class="n">results</span><span class="p">,</span> <span class="n">n_obs</span> <span class="o">=</span> <span class="n">hyswap</span><span class="o">.</span><span class="n">similarity</span><span class="o">.</span><span class="n">calculate_energy_distance</span><span class="p">(</span><span class="n">df_list</span><span class="p">,</span> <span class="s2">&quot;00060_Mean&quot;</span><span class="p">)</span>

<span class="c1"># make plot</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">hyswap</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">plot_similarity_heatmap</span><span class="p">(</span>
    <span class="n">results</span><span class="p">,</span> <span class="n">n_obs</span><span class="o">=</span><span class="n">n_obs</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Energy Distances for Streamflow</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
          <span class="s2">&quot;Between 5 Sites Along the Mississippi River&quot;</span><span class="p">,</span>
    <span class="n">show_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/49384fb54eb1dfe3c84bac7d3e069bfc/similarity_examples-5.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/1e8236fb3d31a317b1c34ff861150124/similarity_examples-5.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/similarity_examples-5.png" class="plot-directive" src="../_images/similarity_examples-5.png" />
</figure>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Similarity Measures</a><ul>
<li><a class="reference internal" href="#correlations-between-5-stations">Correlations Between 5 Stations</a></li>
<li><a class="reference internal" href="#wasserstein-distances-between-5-stations">Wasserstein Distances Between 5 Stations</a></li>
<li><a class="reference internal" href="#energy-distances-between-5-stations">Energy Distances Between 5 Stations</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="percentile_calculation_examples.html"
                          title="previous chapter">Percentile Calculation Examples</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../meta/glossary.html"
                          title="next chapter">Glossary</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/examples/similarity_examples.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../meta/glossary.html" title="Glossary"
             >next</a> |</li>
        <li class="right" >
          <a href="percentile_calculation_examples.html" title="Percentile Calculation Examples"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">hyswap 0.1.dev1+gf39d874 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Examples</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Similarity Measures</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright .
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>